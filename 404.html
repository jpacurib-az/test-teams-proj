<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Auth Redirect</title>   
</head>

<body>  
  Auth Redirect
  <br/>
  <form>
    <input type="text" id="START" readonly="true" style="width: 600px;"/ >
    <br/>
    <input type="text" id="END" readonly="true" style="width: 600px;"/ >    
    <br/>
    1.4
  </form>
</body>

<script src="https://statics.teams.microsoft.com/sdk/v1.5.2/js/MicrosoftTeams.min.js" crossorigin="anonymous"></script>  
<script type="text/javascript">     
  microsoftTeams.initialize();
  var url = new URL(window.location.href);
  
  var startUrl = url.searchParams.get("start");
  if (startUrl) {  
    document.getElementById("START").value = startUrl;
    window.location.href = startUrl;
  } 
  
  // userId and requestId gets populated after successful login
  var userId = url.searchParams.get("userId");
  var requestId = url.searchParams.get("requestId");
  if (userId && requestId) {
    document.getElementById("END").value = url.search;
    
    var data = [];
    data["userId"] = userId;
    data["requestId"] = requestId;
    
    localStorage.setItem("MS_ADAPTER_LOGIN_RESULT", data)
    microsoftTeams.authentication.notifySuccess("success");
    window.close();
  }  
  
</script>
</html>
